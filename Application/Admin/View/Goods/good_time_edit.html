<extend name="Base/common"/>
<block name="content">
    <style>
        .new-user .form-wrapper input[type="text"]{border: 1px solid #D0D0D0;}
        .ui-timepicker-div .ui-widget-header { margin-bottom: 8px;}
        .ui-timepicker-div dl { text-align: left; }
        .ui-timepicker-div dl dt { height: 25px; margin-bottom: -25px; }
        .ui-timepicker-div dl dd { margin: 0 10px 10px 65px; }
        .ui-timepicker-div td { font-size: 90%; }
        .ui-tpicker-grid-label { background: none; border: none; margin: 0; padding: 0; }
        .ui_tpicker_hour_label,.ui_tpicker_minute_label,.ui_tpicker_second_label,.ui_tpicker_millisec_label,.ui_tpicker_time_label{padding-left:20px}
        .ui-datepicker-buttonpane .ui-priority-secondary, .ui-datepicker-buttonpane .ui-priority-primary {height:32px;}
        #pad-wrapper{margin-top:5px;}


    </style>
    <div class="container-fluid">
        <div id="pad-wrapper"  class="new-user">

            <div class="row-fluid header">
            <form  action="" id="id_form" method="post" name="del">
                <input type="hidden" name="option_id" value="{$option_id}">
                <div class="row-fluid table">
                    <table class="table table-hover">
                        <thead>
                        <tr>
                            <th class="span1 sortable">
                                交易开始时间
                            </th>
                            <th class="span1 sortable">
                                <span class="line"></span>交易结束时间
                            </th>

                            <th class="span1 sortable">
                                <span class="line"></span>
                            </th>

                        </tr>
                        </thead>
                        <tbody id="time_items">
                        <volist name="goodTimeRs" id="v">
                            <!-- row -->
                            <tr class="first">
                                <td>
                                    <input class="span2" value="{$v['deal_time_start1']}"  type="text" name="time_code[time_start][]" />
                                </td>
                                <td>
                                    <input class="span2" value="{$v['deal_time_end1']}"  type="text" name="time_code[time_end][]" />
                                    <select name="deal_type[time_type][]" style="width:100px;height:30px;">
                                    <if condition="$v['deal_time_type'] eq 1"> 
                                        <option value="1" selected="true">今日</option>
                                        <option value="2">次日</option>
                                    <else />
                                        <option value="1">今日</option>
                                        <option value="2" selected="true">次日</option>
                                    </if>
                                    </select>
                                </td>
                                <td>
                                    <a class="delete_item" href="javascript:void(0);">X</a>
                                </td>

                            </tr>
                        </volist>
                        <tr class="first">
                            <td>
                                <input class="span2" value=""  type="text" name="time_code[time_start][]" />
                            </td>
                            <td>
                                <input class="span2" value=""  type="text" name="time_code[time_end][]" />
                                <select name="deal_type[time_type][]" style="width:100px;height:30px;">
                                    <option value="1">今日</option>
                                    <option value="2">次日</option>
                                </select>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </form>
            </div>
            <div style="padding-bottom: 20px; text-align:left;" class="span8 field-box ">
                <input type="button" id="add_item" value="增加" class="btn-glow primary">
                <input type="button" id="submit_btn" value="保存" class="btn-glow primary">
            </div>
        </div>
    </div>



<link rel="stylesheet" type="text/css" href="__JS__/timepicker/css/jquery-ui.css" />
<script type="text/javascript" src="__JS__/jquery.1.7.2.js"></script>
<script type="text/javascript" src="__JS__/timepicker/js/jquery-ui.js"></script>
<script type="text/javascript" src="__JS__/timepicker/js/jquery-ui-slide.min.js"></script>
<script type="text/javascript" src="__JS__/timepicker/js/jquery-ui-timepicker-addon.js"></script>


    <script type="text/javascript">

        $('#add_item').click(function(){

            var add_html    = '<tr class="first">'+
                    '<td>'+
                    '<input class="span2" value=""  type="text" name="time_code[time_start][]" />'+
                    '</td>'+
                    '<td>'+
                    '<input class="span2" value=""  type="text" name="time_code[time_end][]" />'+
                    '<select name="deal_type[time_type][]" style="width:100px;height:30px;">'+
                    '<option value="1">今日</option>'+
                    '<option value="2">次日</option>'+
                    '</select>'+
                    '</td>'+
                    '</tr>';
            $('#time_items').append(add_html);
        });



        $(document).ready(function(){
            $('.span2').live('mouseover',function(){
                $(this).timepicker({});
            });

            $('.delete_item').live('click', function(){
                $(this).parent().parent().remove();
            });
        });

        $('#submit_btn').bind('click', function(){
            keywords = $(this).val();
            $.ajax({
                type: "post",
                url: "{:U('Goods/good_time_edit_opt')}",
                data:$("#id_form").serialize(),
                success: function(data) {
                    console.log(data);
                    if(data.status == 1)
                    {
                        alert('保存成功');
                        parent.location.reload();
                        var index = parent.layer.getFrameIndex(window.name); //获取窗口索引
                        parent.layer.close(index);
                    }
                    else
                    {
                        alert(data.ret_msg);
                    }

                },
                error: function(data) {
                    console.log(data);
                }
            })
        });

    </script>
</block>